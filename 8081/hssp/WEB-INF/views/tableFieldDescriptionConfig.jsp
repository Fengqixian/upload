<%@ page language="java" contentType="text/html; charset=UTF-8"    pageEncoding="UTF-8"%><!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"><html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>Insert title here</title><link rel="stylesheet" type="text/css" href="${pageContext.request.contextPath}/resources/css/basictable.css" />        <link rel="icon" href="${pageContext.request.contextPath}/resources/images/logo ico.png">        <link rel="stylesheet" href="${pageContext.request.contextPath}/resources/css/Css/bootstrap-3.2.0/bootstrap-theme.min.css" />    <link rel="stylesheet" href="${pageContext.request.contextPath}/resources/css/Css/bootstrap-3.2.0/bootstrap.min.css" />        <!--  <link rel="stylesheet" href="${pageContext.request.contextPath}/resources/css/Css/bootstrap-3.3.5-dist/css/bootstrap.css" />    <link rel="stylesheet" href="${pageContext.request.contextPath}/resources/css/Css/bootstrap-3.3.5-dist/css/bootstrap-theme.css" />-->        <link rel="stylesheet" href="${pageContext.request.contextPath}/resources/css/Css/css_config.css"  />    <link rel="stylesheet" href="${pageContext.request.contextPath}/resources/css/Css/jquery-ui-1.11.2.custom/jquery-ui.css" />    <link rel="stylesheet" href="${pageContext.request.contextPath}/resources/css/Css/coverage.css" />    <link rel="stylesheet" href="${pageContext.request.contextPath}/resources/css/Css/bootstrap-table-fixed-columns.css">    <link rel="stylesheet" href="${pageContext.request.contextPath}/resources/js/Scriptsbybs/bootstrap-table-develop/dist/bootstrap-table.min.css">      <script src="${pageContext.request.contextPath}/resources/js/Scriptsbybs/jquery-2.1.1.min.js"></script>    <script src="${pageContext.request.contextPath}/resources/css/Css/bootstrap-3.3.5-dist/js/bootstrap.min.js"></script>	<script src="${pageContext.request.contextPath}/resources/js/Scriptsbybs/bootstrap-treeview-dist/bootstrap-treeview.min.js"></script>    <script src="${pageContext.request.contextPath}/resources/js/Scriptsbybs/bootstrap-table-develop/dist/bootstrap-table.min.js"></script>    <script src="${pageContext.request.contextPath}/resources/js/Scriptsbybs/bootstrap-table-develop/dist/locale/bootstrap-table-zh-CN.js"></script>   	<script src="${pageContext.request.contextPath}/resources/js/js/jquery.validate.js"></script>	<script src="${pageContext.request.contextPath}/resources/js/js/jquery.form.js"></script>	 <script src="${pageContext.request.contextPath}/resources/js/Scriptsbybs/jquery-ui-1.11.2.custom/jquery-ui.js"></script>	 <script type="text/javascript" src="${pageContext.request.contextPath}/resources/js/js/jquery.basictable.min.js"></script>	 <link rel="stylesheet" href="${pageContext.request.contextPath}/resources/clinbrain/ztree/zTreeStyle.css" />	<script src="${pageContext.request.contextPath}/resources/clinbrain/ztree/jquery.ztree.all.js"></script>	</head><body>	<!-- 表头按钮展示 -->	<div id="priUser_div"  style=" height:100%; width:100%; overflow:auto; float:left;">		<div id="toolbarPriField" class="btn-group">			<button id="addUser" type="button" class="btn btn-primary"  onclick="addTableFieldDescription()">	            <span class="glyphicon glyphicon-plus" aria-hidden="true" ></span>新增	        </button>	        <button  type="button" class="btn btn-primary" id="hsz" onclick="queryTableField('1')">                <span class="glyphicon glyphicon-trash" aria-hidden="true" ></span>回收站            </button>            <button  type="button" class="btn btn-primary" id="yxlb" style="display: none;"  onclick="queryTableField('0')">                <span class="glyphicon glyphicon-trash" aria-hidden="true" ></span>返回有效列表            </button>            <span style="float: left; line-height: 34px;">表名称：</span><input id="searchTableName" class="form-control" style="float: left;width: 140px;"/>              <span style="float: left; line-height: 34px;">表字段名称：</span><input id="searchFieldName" class="form-control" style="float: left;width: 140px;"/>            <!--             <span style="float: left; line-height: 34px;">表字段说明：</span><input id="searchDescription" class="form-control" style="float: left;width: 140px;"/>              --> 		    <button onclick="searchTableField()" class="btn btn-primary">检索</button>	    </div>		<table  id="priUserTable"></table>	</div>	<!-- 新增展示 -->	<div class="modal fade" id="myModal_tableFieldDescriptionAdd" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">        <div class="modal-dialog" role="document">            <div class="modal-content">                <div class="modal-header">                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>                    <h4 class="modal-title" id="tableFieldDescriptionAdd_Label">用户信息修改</h4>                </div>                <div class="modal-body">	               <!--  <div>表名称：<input type="text" id="tableNameAdd" /></div>	                <div>表字段名称：<input type="text" id="fieldNameAdd" /></div>  --> 					<div>表字段说明：<input type="text"  id="descriptionAdd"/></div>	            </div>                <div class="modal-footer">                    <button type="button" class="btn btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove" aria-hidden="true"></span>关闭</button>                    <button type="button" id="btn_submit" class="btn btn-primary" data-dismiss="modal" onclick="saveTableFieldDescription()"><span class="glyphicon glyphicon-floppy-disk" aria-hidden="true"></span>保存</button>                </div>            </div>        </div>    </div>    <!-- 修改配置页面 -->	<div class="modal fade" id="showUpdateTableFieldDescription" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">        <div class="modal-dialog" role="document">            <div class="modal-content">                <div class="modal-header">                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>                    <h4 class="modal-title" id="showUpdateTableFieldDescription_Label">修改</h4>                </div>                <div class="modal-body">	                <div>表名称：<input type="text" id="tableNameEdit" readonly= "true"/></div>	                <div>表字段名称：<input type="text" id="fieldNameEdit" readonly= "true"/></div>					<div>表字段说明：<input type="text"  id="descriptionEdit"/></div>	            </div>                <div class="modal-footer">                    <button type="button" class="btn btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-remove" aria-hidden="true"></span>关闭</button>                    <button type="button" id="btn_submit" class="btn btn-primary" data-dismiss="modal" onclick="saveTableFieldDescriptionEdit()"><span class="glyphicon glyphicon-floppy-disk" aria-hidden="true"></span>保存</button>                </div>            </div>        </div>    </div>    <div id="hiddenInfo" style="display: none">		<form id="getForm">			<input type="text" name="hid_Id" id="hid_Id" />			<input type="text" name="hid_isDeleted" id="hid_isDeleted" />		</form>	</div>	</body><script type="text/javascript">	$(document).ready(function () {        	    //调用函数，初始化表格	    queryTableField(0);	    //当点击查询按钮的时候执行		document.getElementById('priUser_div').style.display='block';	    	});	function queryTableField(isDeleted){		$("#searchTableName").val("");		$("#searchFieldName").val("");		$("#searchDescription").val("");		initTableField(isDeleted,"","","");	}		//用户信息准备页面	function initTableField(isDeleted,tableName,fieldName,description) {		$("#hid_isDeleted").val(isDeleted);		if(isDeleted==0){	     	 $("#addUser").show();	     	 $("#hsz").show();	     	 $("#yxlb").hide(); 	      }else{	   		 $("#yxlb").show();	   		 $("#addUser").hide();	   		 $("#hsz").hide();	   	  }	  //先销毁表格	  $("#priUserTable").bootstrapTable('destroy');	  //初始化表格,动态从服务器加载数据	  $("#priUserTable").bootstrapTable({	      url: "/hssp/configTableController/getTableFieldDescription", //获取数据的Servlet地址		  method: "POST",  //使用get请求到服务器获取数据		  contentType: "application/x-www-form-urlencoded",//post请求的话就加上这个句话		  toolbar: "#toolbarPriField",                //工具按钮用哪个容器	      striped: true,                      //是否显示行间隔色	      cache: false,                       //是否使用缓存，默认为true，所以一般情况下需要设置一下这个属性（*）	      pagination: true,                   //是否显示分页（*）	      sortable: false,                     //是否启用排序	      sortOrder: "asc",                   //排序方式	      sidePagination: "client",           //分页方式：client客户端分页，server服务端分页（*）	      pageNumber:1,                       //初始化加载第一页，默认第一页	      pageSize: 10,                       //每页的记录行数（*）	      pageList: [5, 10],        			//可供选择的每页的行数（*）	      search: false,                       //是否显示表格搜索，此搜索是客户端搜索，不会进服务端，所以，个人感觉意义不大	      strictSearch: true,	      showColumns: false,                  //是否显示所有的列	      showRefresh: false,                  //是否显示刷新按钮	      minimumCountColumns: 2,             //最少允许的列数	      clickToSelect: true,                //是否启用点击选中行	      height: "",                        //行高，如果没有设置height属性，表格自动根据记录条数觉得表格高度	      uniqueId: "ID",                     //每一行的唯一标识，一般为主键列	      showToggle:false,                    //是否显示详细视图和列表视图的切换按钮	      cardView: false,                    //是否显示详细视图	      detailView: false,                   //是否显示父子表	      queryParams: function queryParams(params) {   //设置查询参数	        var param = {  	            pageNumber: params.pageNumber,  	            pageSize: params.pageSize,	            isDeleted : isDeleted,	            tableName : tableName,	            fieldName : fieldName,	            description : description	        };  	        return param;                 	      },	     	      formatLoadingMessage: function () {	          return "请稍等，正在加载中...";	      },	      formatNoMatches: function () {  //没有匹配的结果	          return '无符合条件的记录';	      },            	      columns: [	              {	    	          title: "序号",	    	          field: "rowNum",	    	          valign:'middle',	    	          align:'center',	    	          formatter:function(value,row,index){ 		              	  return index+1;  	   	 	          } 	              },  	              {	                  title: '表名称',	                  field: 'tableName',	                  align: 'center',	                  valign: 'middle',	              }, 	              {	                  title: '表字段名称',	                  field: 'FieldName',	                  align: 'center',	                  valign: 'middle',	              }, 	              {	                title: '表字段说明',	                  field: 'Description',	                  align: 'center',	                  valign: 'middle'	              }, 	              {	                  title: '操作',	                  field: 'Id',	                  align: 'center',	                  formatter:function(value,row,index){	                  	if(isDeleted==0){			            	var a = "<a href=\"#\" mce_href=\"#\" onclick=\"editTableFieldDescription('"+ row.Id+"','"+row.tableName+"','"+row.FieldName+"','"+row.Description+"')\">修改</a> ";			            	var e = "";			            	if(row.Data_Type != 1){			            		e = "<a href=\"#\" mce_href=\"#\" onclick=\"restoreUser('"+ row.Id +"',"+1+")\">删除</a> ";			            	}		              		return a+e; 		              	}else{		               		var d = "<a href=\"#\" mce_href=\"#\" onclick=\"restoreUser('"+ row.Id+"',"+0+")\">恢复</a> ";		                	return d;		               	} 	                } 	              }	          ],	          responseHandler: function(data){	              return data.rows;	      	  }	    });	}      //新增界面      function addTableFieldDescription(){      	  $("#tableFieldDescriptionAdd_Label").text("新增表列头管理信息");  	      $("#myModal_tableFieldDescriptionAdd").modal();      }      var reg = new RegExp(" ","g");      function saveTableFieldDescription(){      	  // var tableName = $("#tableNameAdd").val().replace(reg,"");      	  var tableName = "Privilege_User";		   var description = $("#descriptionAdd").val().replace(reg,"");		   //var fieldName = $("#fieldNameAdd").val().replace(reg,"");		   		   /*if(tableName ==""){			  alert("表名称不能为空");			  return;			}		    if(fieldName ==""){				  alert("表字段名称不能为空");				  return;				} */		   if(description ==""){				  alert("表字段说明不能为空");				  return;				}			var datas = {					tableName : tableName,					description : description					//fieldName : fieldName	    	};			 $.ajax({	 	        type:"POST",	 	        url:"/hssp/configTableController/insertTableFieldDescription",	 	        dataType: "json",	 	        data:datas,	 	        cache: false,		        async : false,	 	        success:function(result){	 	        	if (result.status == "succeed"){	 	        		alert("保存成功!");	 	        			 	        	}				}	 	    });			 queryTableField(0);      }          //删除恢复表列头管理信息    function restoreUser(id,isDeleted){    	var datas = {	    	id : id,	    	isDeleted : isDeleted    	};		 $.ajax({ 	        type:"POST", 	        url:"/hssp/configTableController/deleteTableFieldDescription", 	        dataType: "json", 	        data:datas, 	        cache: false,	        async : false, 	        success:function(result){ 	        	if (result.status == "succeed" && isDeleted=="0"){ 	        		alert("该表列头恢复成功，请在有效列表查看!"); 	        	} 	        	if (result.status == "succeed" && isDeleted=="1"){ 	        		alert("该表列头删除成功，可以在回收站恢复!"); 	        	} 	        	if(result.status == "exist"){ 	        		alert("修改失败，该表字段说明已经存在!"); 	        	}			} 	    }); 	    if(isDeleted=="0"){			queryTableField(1); 	    }else{			queryTableField(0); 	    }    }        //修改界面展示    function editTableFieldDescription(id,tableName,fieldName,description){      	$("#hid_Id").val(id);		$("#tableNameEdit").val(tableName);		$("#fieldNameEdit").val(fieldName);		$("#descriptionEdit").val(description);	    $("#showUpdateTableFieldDescription_Label").text("修改表列头管理信息");	    $("#showUpdateTableFieldDescription").modal();     }          //修改保存	function saveTableFieldDescriptionEdit(){		var id =$("#hid_Id").val();		var description= $("#descriptionEdit").val();		if(description ==""){			alert("表字段说明不能为空");			return;		}		var datas = {				id:id,				description : description    	};		 $.ajax({ 	        type:"POST", 	        url:"/hssp/configTableController/updateTableFieldDescription", 	        dataType: "json", 	        data:datas, 	        cache: false,	        async : false, 	        success:function(result){ 	        	if (result.status == "succeed"){ 	        		alert("修改成功!"); 	        	}else if(result.status == "exist"){ 	        		alert("修改失败，该表字段说明已经存在!"); 	        	}			} 	    });		queryTableField(0);    }    /**	 * 搜索用户表列头设置 	 */	function searchTableField() {		var isDeleted=$("#hid_isDeleted").val();		var tableName = $("#searchTableName").val();		var fieldName = $("#searchFieldName").val();		var description = $("#searchDescription").val();		initTableField(isDeleted,tableName,fieldName,description);	}</script></html>